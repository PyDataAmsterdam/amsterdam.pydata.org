{"version":3,"file":"gatsby-node.js","names":["isEqual","require","emitter","store","actions","originalStatusPageByStatus","originalStatusPageByPath","on","action","result","exec","payload","path","length","status","originalPage","pageToStore","component","context","slices","dispatch","createPage","plugin","storedPage","deletePage"],"sources":["../../../src/internal-plugins/prod-404-500/gatsby-node.js"],"sourcesContent":["const isEqual = require(`lodash/isEqual`)\n\nconst { emitter, store } = require(`../../redux`)\nconst { actions } = require(`../../redux/actions`)\n\nconst originalStatusPageByStatus = {}\nconst originalStatusPageByPath = {}\n\nemitter.on(`CREATE_PAGE`, action => {\n  // Copy /404/ to /404.html and /500/ to /500.html. Many static site hosts expect\n  // site 404 pages to be named this. In addition, with Rendering Engines there might\n  // be runtime errors which would fallback to \"/500.html\" page.\n  // https://www.gatsbyjs.com/docs/how-to/adding-common-features/add-404-page/\n  const result = /^\\/?(404|500)\\/?$/.exec(action.payload.path)\n  if (result && result.length > 1) {\n    const status = result[1]\n\n    const originalPage = originalStatusPageByStatus[status]\n\n    const pageToStore = {\n      path: action.payload.path,\n      component: action.payload.component,\n      context: action.payload.context,\n      slices: action.payload.slices,\n      status,\n    }\n\n    if (!originalPage || !isEqual(originalPage, pageToStore)) {\n      originalStatusPageByStatus[status] = pageToStore\n      originalStatusPageByPath[action.payload.path] = pageToStore\n\n      store.dispatch(\n        actions.createPage(\n          {\n            ...pageToStore,\n            path: `/${status}.html`,\n          },\n          action.plugin,\n          action\n        )\n      )\n    }\n  }\n})\n\nemitter.on(`DELETE_PAGE`, action => {\n  const storedPage = originalStatusPageByPath[action.payload.path]\n  if (storedPage) {\n    store.dispatch(\n      actions.deletePage({\n        ...storedPage,\n        path: `/${storedPage.status}.html`,\n      })\n    )\n    originalStatusPageByPath[action.payload.path] = null\n    originalStatusPageByStatus[storedPage.status] = null\n  }\n})\n"],"mappings":";;AAAA,MAAMA,OAAO,GAAGC,OAAO,CAAE,gBAAe,CAAC;AAEzC,MAAM;EAAEC,OAAO;EAAEC;AAAM,CAAC,GAAGF,OAAO,CAAE,aAAY,CAAC;AACjD,MAAM;EAAEG;AAAQ,CAAC,GAAGH,OAAO,CAAE,qBAAoB,CAAC;AAElD,MAAMI,0BAA0B,GAAG,CAAC,CAAC;AACrC,MAAMC,wBAAwB,GAAG,CAAC,CAAC;AAEnCJ,OAAO,CAACK,EAAE,CAAE,aAAY,EAAEC,MAAM,IAAI;EAClC;EACA;EACA;EACA;EACA,MAAMC,MAAM,GAAG,mBAAmB,CAACC,IAAI,CAACF,MAAM,CAACG,OAAO,CAACC,IAAI,CAAC;EAC5D,IAAIH,MAAM,IAAIA,MAAM,CAACI,MAAM,GAAG,CAAC,EAAE;IAC/B,MAAMC,MAAM,GAAGL,MAAM,CAAC,CAAC,CAAC;IAExB,MAAMM,YAAY,GAAGV,0BAA0B,CAACS,MAAM,CAAC;IAEvD,MAAME,WAAW,GAAG;MAClBJ,IAAI,EAAEJ,MAAM,CAACG,OAAO,CAACC,IAAI;MACzBK,SAAS,EAAET,MAAM,CAACG,OAAO,CAACM,SAAS;MACnCC,OAAO,EAAEV,MAAM,CAACG,OAAO,CAACO,OAAO;MAC/BC,MAAM,EAAEX,MAAM,CAACG,OAAO,CAACQ,MAAM;MAC7BL;IACF,CAAC;IAED,IAAI,CAACC,YAAY,IAAI,CAACf,OAAO,CAACe,YAAY,EAAEC,WAAW,CAAC,EAAE;MACxDX,0BAA0B,CAACS,MAAM,CAAC,GAAGE,WAAW;MAChDV,wBAAwB,CAACE,MAAM,CAACG,OAAO,CAACC,IAAI,CAAC,GAAGI,WAAW;MAE3Db,KAAK,CAACiB,QAAQ,CACZhB,OAAO,CAACiB,UAAU,CAChB;QACE,GAAGL,WAAW;QACdJ,IAAI,EAAG,IAAGE,MAAO;MACnB,CAAC,EACDN,MAAM,CAACc,MAAM,EACbd,MAAM,CACP,CACF;IACH;EACF;AACF,CAAC,CAAC;AAEFN,OAAO,CAACK,EAAE,CAAE,aAAY,EAAEC,MAAM,IAAI;EAClC,MAAMe,UAAU,GAAGjB,wBAAwB,CAACE,MAAM,CAACG,OAAO,CAACC,IAAI,CAAC;EAChE,IAAIW,UAAU,EAAE;IACdpB,KAAK,CAACiB,QAAQ,CACZhB,OAAO,CAACoB,UAAU,CAAC;MACjB,GAAGD,UAAU;MACbX,IAAI,EAAG,IAAGW,UAAU,CAACT,MAAO;IAC9B,CAAC,CAAC,CACH;IACDR,wBAAwB,CAACE,MAAM,CAACG,OAAO,CAACC,IAAI,CAAC,GAAG,IAAI;IACpDP,0BAA0B,CAACkB,UAAU,CAACT,MAAM,CAAC,GAAG,IAAI;EACtD;AACF,CAAC,CAAC"}